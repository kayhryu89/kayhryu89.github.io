---
title: "Publications"
page-layout: full
toc: true
bibliography: ./Info/Bib/journal.bib
nocite: |
  @*
filters:
  - author-format.lua
---

<sup>†</sup>: First author, <sup>✻</sup>: Corresponding author

::: {#refs}
:::

```{=html}
<script>
document.addEventListener("DOMContentLoaded", function() {
  const refsDiv = document.getElementById("refs");
  if (!refsDiv) return;

  const bibDataEl = document.getElementById("bib-data");
  if (!bibDataEl) return;
  const bibData = JSON.parse(bibDataEl.textContent);

  const entries = Array.from(refsDiv.querySelectorAll("div.csl-entry"));
  if (entries.length === 0) return;

  const items = entries.map(div => {
    const key = div.id.replace("ref-", "");
    const yearMatch = key.match(/(\d{4})/);
    const year = yearMatch ? parseInt(yearMatch[1]) : 0;
    const data = bibData[key] || {};
    const bibOrder = data.order || 9999;
    return { div, key, year, bibOrder, data };
  });

  // Sort: year descending, bib file order ascending within same year
  items.sort((a, b) => {
    if (a.year !== b.year) return b.year - a.year;
    return a.bibOrder - b.bibOrder;
  });

  const total = items.length;

  items.forEach((item) => {
    const authorship = item.data.authorship || "";
    const doi = item.data.doi || "";
    const bibAuthors = item.data.authors || "";
    let suffix = "";
    if (/First/i.test(authorship)) suffix += "†";
    if (/Corresponding/i.test(authorship)) suffix += "✻";

    let html = item.div.innerHTML;

    // Fix em-dash substitution (———.) by replacing with actual authors from bib
    if (html.match(/^———\./)) {
      html = html.replace(/^———\./, bibAuthors + ".");
    }

    // Fix first author "Family, Given" format to "Given Family"
    // CSL renders first author as "Family, Given" - convert to "Given Family"
    html = html.replace(
      /^([A-Z][a-zA-Zé\u00C0-\u024F-]+),\s+([A-Z][a-zA-Zé\u00C0-\u024F\s.-]+?)(?=,\s|\.?\s+\d{4})/,
      function(match, family, given) {
        return given.trim() + " " + family;
      }
    );

    // Bold "Kyung Hwan Ryu" with authorship markers
    html = html.replace(/Kyung Hwan Ryu/g, function() {
      const sup = suffix ? "<sup>" + suffix + "</sup>" : "";
      return "<strong>Kyung Hwan Ryu</strong>" + sup;
    });

    // Also catch "Ryu, Kyung Hwan" if still present
    html = html.replace(/Ryu, Kyung Hwan/g, function() {
      const sup = suffix ? "<sup>" + suffix + "</sup>" : "";
      return "<strong>Kyung Hwan Ryu</strong>" + sup;
    });

    // Add DOI link at the end (before closing, remove any existing DOI text)
    if (doi) {
      // Remove existing DOI URL text that citeproc may have added
      html = html.replace(/\s*https?:\/\/doi\.org\/\S+/g, "");
      html = html.replace(/<a\s+href="https:\/\/doi\.org\/[^"]*"[^>]*>[^<]*<\/a>\.?/g, "");
      // Remove trailing period and whitespace, then add LINK
      html = html.replace(/\.\s*$/, "");
      html += '. <a href="' + doi + '" target="_blank">[LINK]</a>';
    }

    item.div.innerHTML = html;
  });

  // Clear and rebuild with year headers and index numbers
  refsDiv.innerHTML = "";
  let currentLabel = null;

  items.forEach((item, idx) => {
    const indexNum = total - idx;
    const label = item.year <= 2020 ? "~2020" : String(item.year);

    if (label !== currentLabel) {
      currentLabel = label;
      const h2 = document.createElement("h2");
      h2.textContent = label;
      h2.className = "pub-year-header";
      refsDiv.appendChild(h2);
    }

    const indexSpan = document.createElement("span");
    indexSpan.className = "pub-index";
    indexSpan.textContent = "[" + indexNum + "] ";
    item.div.insertBefore(indexSpan, item.div.firstChild);

    refsDiv.appendChild(item.div);
  });
});
</script>
```
